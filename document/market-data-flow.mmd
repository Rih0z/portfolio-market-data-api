flowchart TB
    subgraph Client["クライアント"]
        Frontend["フロントエンドアプリケーション"]
    end
    
    subgraph AWS["AWS クラウド"]
        APIGateway["API Gateway"]
        
        subgraph Lambda["Lambda 関数"]
            MarketData["マーケットデータAPI"]
            Auth["認証関数群"]
            Drive["Google Drive連携関数群"]
            Admin["管理者機能"]
            Prewarm["キャッシュ予熱"]
        end
        
        DynamoDB[(DynamoDB)]
        SNS["SNSアラート"]
    end
    
    subgraph DataSources["データソース"]
        subgraph ProviderModule["マーケットデータプロバイダ"]
            YahooAPI["Yahoo Finance API"]
            Scraping["ウェブスクレイピング"]
            ExchangeRate["為替レートAPI"]
        end
        
        subgraph Google["Google Cloud"]
            GoogleAuth["Google Auth"]
            GoogleDrive["Google Drive"]
        end
    end
    
    Frontend <--> APIGateway
    APIGateway <--> Lambda
    
    MarketData <-- "データ取得/キャッシュ" --> DynamoDB
    Auth <-- "セッション管理" --> DynamoDB
    
    MarketData -- "データ取得" --> ProviderModule
    Auth -- "認証" --> GoogleAuth
    Drive -- "ファイル操作" --> GoogleDrive
    
    ProviderModule <-- "データ取得" --> DataSources
    
    MarketData -- "アラート" --> SNS
    Prewarm -- "アラート" --> SNS
    
    classDef aws fill:#FF9900,stroke:#232F3E,color:white;
    classDef lambda fill:#009ACD,stroke:#232F3E,color:white;
    classDef google fill:#4285F4,stroke:#232F3E,color:white;
    classDef provider fill:#107E3E,stroke:#232F3E,color:white;
    
    class APIGateway,DynamoDB,SNS aws;
    class MarketData,Auth,Drive,Admin,Prewarm lambda;
    class GoogleAuth,GoogleDrive google;
    class ProviderModule,YahooAPI,Scraping,ExchangeRate provider;
